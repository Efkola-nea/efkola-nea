<!doctype html>
<html lang="el">
  <head>
    <meta charset="utf-8" />
    <title>Î•ÏÎºÎ¿Î»Î± ÎÎ­Î± â€“ ÎšÎ±Ï„Î·Î³Î¿ÏÎ¯Î±</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />

    <style>
      :root {
        --bg: #020617;
        --card-bg: #111827; /* ÏƒÎºÎ¿ÏÏÎ¿ Î³ÎºÏÎ¹ */
        --card-border: rgba(148, 163, 184, 0.3);
        --accent: #60a5fa;
        --text-main: #e5e7eb;
        --text-muted: #9ca3af;
      }

      body {
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        background-color: var(--bg);
        color: var(--text-main);
        font-size: 18px;
        line-height: 1.7;
        margin: 0;
      }

      a {
        color: var(--accent);
        text-decoration: none;
      }

      a:hover {
        color: #93c5fd;
      }

      .site-header {
        background: #0b1224;
        color: var(--text-main);
        padding: 1.6rem 0;
        margin-bottom: 1.6rem;
        border-bottom: 1px solid var(--card-border);
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.28);
        position: sticky;
        top: 0;
        z-index: 1000;
      }

      .site-title {
        font-size: 2rem;
        font-weight: 800;
        letter-spacing: 0.3px;
      }
      .site-subtitle {
        font-size: 1rem;
        color: var(--text-muted);
        margin-top: 0.25rem;
      }
      .back-link {
        font-size: 1rem;
        margin-bottom: 1.1rem;
        display: inline-flex;
        align-items: center;
        gap: 0.4rem;
        padding: 0.45rem 0.95rem;
        border-radius: 999px;
        border: 1px solid var(--card-border);
        color: var(--text-main);
        text-decoration: none;
        font-weight: 700;
      }

      .back-link:hover {
        color: #f8fafc;
        border-color: rgba(96, 165, 250, 0.7);
        background: rgba(96, 165, 250, 0.08);
      }

      /* ===== ÎšÎ»Î±ÏƒÎ¹ÎºÎ­Ï‚ ÎºÎ¬ÏÏ„ÎµÏ‚ Î¬ÏÎ¸ÏÏ‰Î½ ===== */
      .article-card {
        border-radius: 1rem;
        border: 1px solid var(--card-border);
        padding: 1rem 1.1rem;
        margin-bottom: 1rem;
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.28);
        background: var(--card-bg);
        transition: border-color 0.14s ease, transform 0.14s ease;
        position: relative;
        cursor: pointer;
      }

      .article-card:hover {
        border-color: rgba(96, 165, 250, 0.7);
        transform: translateY(-2px);
      }

      .article-card h2 {
        margin-top: 0;
        font-size: 1.15rem;
        color: var(--text-main);
        font-weight: 800;
      }

      .meta {
        font-size: 0.95rem;
        color: var(--text-muted);
        margin-bottom: 0.45rem;
      }

      .content {
        white-space: pre-wrap;
        font-size: 1.02rem;
      }

      .article-thumb {
        width: 100%;
        height: 160px;
        object-fit: cover;
        border-radius: 0.75rem;
        margin-bottom: 0.6rem;
        border: 1px solid var(--card-border);
        display: block;
      }

      /* Placeholder ÏŒÏ„Î±Î½ Î´ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ ÎµÎ¹ÎºÏŒÎ½Î± */
      .article-thumb-placeholder {
        width: 100%;
        height: 160px;
        border-radius: 0.75rem;
        margin-bottom: 0.6rem;
        border: 1px solid var(--card-border);
        background: linear-gradient(135deg, rgba(96, 165, 250, 0.18), rgba(148, 163, 184, 0.08));
        display: grid;
        place-items: center;
        color: rgba(229, 231, 235, 0.8);
        font-size: 2rem;
        user-select: none;
      }

      /* ===== Grid Î³Î¹Î± "ÎŒÎ»ÎµÏ‚ Î¿Î¹ ÎµÎ¹Î´Î®ÏƒÎµÎ¹Ï‚" (2 ÏƒÏ„Î®Î»ÎµÏ‚) ===== */
      .articles-grid {
        display: grid;
        grid-template-columns: repeat(2, minmax(0, 1fr));
        gap: 1.25rem;
      }
      .articles-grid .article-card {
        margin-bottom: 0; /* Ï„Î¿ gap Ï„Î·Ï‚ grid Î±Î½Î±Î»Î±Î¼Î²Î¬Î½ÎµÎ¹ Ï„Î± ÎºÎµÎ½Î¬ */
        height: 100%;
      }

      /* Responsive: ÏƒÎµ ÎºÎ¹Î½Î·Ï„ÏŒ 1 ÏƒÏ„Î®Î»Î· */
      @media (max-width: 576px) {
        .articles-grid {
          grid-template-columns: minmax(0, 1fr);
        }
      }

      /* ===== Grid Î³Î¹Î± ÏƒÎ¿Î²Î±ÏÎ­Ï‚ Î¸ÎµÎ¼Î±Ï„Î¹ÎºÎ­Ï‚ (Î¼Îµ ÎµÎ¹ÎºÏŒÎ½ÎµÏ‚ full) ===== */
      .category-grid {
        display: grid;
        grid-template-columns: repeat(3, minmax(260px, 1fr));
        gap: 1.5rem;
        max-width: 1100px;
        margin: 0 auto 2rem;
        justify-items: center;
      }

      .category-tile {
        border-radius: 1rem;
        background: var(--card-bg);
        border: 1px solid var(--card-border);
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.28);
        overflow: hidden;
        transition: transform 0.14s ease, border-color 0.14s ease, background-color 0.14s ease;
        width: 100%;
        max-width: 340px;
      }

      .category-tile:hover {
        transform: translateY(-2px);
        border-color: rgba(96, 165, 250, 0.7);
        background-color: #0f172a;
      }

      .category-tile-link {
        display: flex;
        flex-direction: column;
        height: 100%;
        text-decoration: none;
        color: inherit;
        padding: 0;
      }

      .category-tile-link:focus-visible {
        outline: 2px solid var(--accent);
        outline-offset: 3px;
        border-radius: 1rem;
      }

      .category-thumbnail-wrapper {
        width: 100%;
        border-radius: 0.9rem 0.9rem 0 0;
        overflow: hidden;
        border-bottom: 1px solid var(--card-border);
        background: var(--card-bg);
      }

      .category-thumbnail {
        width: 100%;
        height: auto;
        display: block;
      }

      .category-tile-body {
        display: flex;
        flex-direction: column;
        gap: 0.3rem;
        padding: 1rem 1.1rem 1.2rem;
      }

      .category-tile-title {
        font-weight: 800;
        font-size: 1.05rem;
        color: var(--text-main);
      }

      .category-tile-subtitle {
        font-size: 0.98rem;
        color: var(--text-muted);
      }

      @media (max-width: 992px) {
        .category-grid {
          grid-template-columns: repeat(2, minmax(240px, 1fr));
        }
      }

      @media (max-width: 576px) {
        .category-grid {
          grid-template-columns: minmax(0, 1fr);
        }
      }
    </style>
  </head>
  <body>
    <!-- Header -->
    <header class="site-header">
      <div class="container">
        <div class="d-flex flex-column align-items-start gap-1">
          <div class="d-flex align-items-center gap-2 flex-wrap">
            <div id="site-title" class="site-title">ğŸ“° Î•ÏÎºÎ¿Î»Î± ÎÎ­Î±</div>
          </div>
          <div class="site-subtitle">Î‘Ï€Î»Î® ÎµÎ½Î·Î¼Î­ÏÏ‰ÏƒÎ· Î³Î¹Î± ÏŒÎ»Î¿Ï…Ï‚</div>
        </div>
      </div>
    </header>

    <main class="container mb-5">
      <a
        href="index.html"
        class="back-link btn btn-outline-light btn-sm rounded-pill d-inline-flex align-items-center gap-2"
      >
        <span aria-hidden="true">â†</span>
        <span>Î Î¯ÏƒÏ‰ ÏƒÏ„Î¿ Î¼ÎµÎ½Î¿Ï ÎºÎ±Ï„Î·Î³Î¿ÏÎ¹ÏÎ½</span>
      </a>
      <h1 id="page-title" class="h4 mb-3">Î•Î¹Î´Î®ÏƒÎµÎ¹Ï‚</h1>

      <div id="content"></div>
    </main>

    <script>
      const params = new URLSearchParams(window.location.search);
      const category = params.get("category") || "serious";
      const pageTitleMap = {
        serious: "Î£Î¿Î²Î±ÏÎ­Ï‚ ÎµÎ¹Î´Î®ÏƒÎµÎ¹Ï‚",
        happy: "Î§Î±ÏÎ¿ÏÎ¼ÎµÎ½ÎµÏ‚ ÎµÎ¹Î´Î®ÏƒÎµÎ¹Ï‚",
        sports: "Î‘Î¸Î»Î·Ï„Î¹ÎºÎ¬",
        screen: "Î¤Î·Î»ÎµÏŒÏÎ±ÏƒÎ· ÎºÎ±Î¹ ÏƒÎ¹Î½ÎµÎ¼Î¬",
        culture: "Î Î¿Î»Î¹Ï„Î¹ÏƒÎ¼ÏŒÏ‚",
        fun: "Î”Î¹Î±ÏƒÎºÎ­Î´Î±ÏƒÎ· / Î’ÏŒÎ»Ï„ÎµÏ‚",
        other: "Î†Î»Î»ÎµÏ‚ ÎµÎ¹Î´Î®ÏƒÎµÎ¹Ï‚",
        all: "ÎŒÎ»ÎµÏ‚ Î¿Î¹ ÎµÎ¹Î´Î®ÏƒÎµÎ¹Ï‚",
      };

      document.getElementById("page-title").textContent =
        pageTitleMap[category] || "Î•Î¹Î´Î®ÏƒÎµÎ¹Ï‚";

      async function loadJson(path) {
        const res = await fetch(path);
        if (!res.ok) {
          throw new Error("Î‘Ï€Î¿Ï„Ï…Ï‡Î¯Î± Ï†ÏŒÏÏ„Ï‰ÏƒÎ·Ï‚ " + path);
        }
        return res.json();
      }

      function formatPublishedAt(publishedAt) {
        if (!publishedAt) return "";
        const d = new Date(publishedAt);
        if (Number.isNaN(d.getTime())) return "";
        return d.toLocaleString("el-GR", {
          year: "numeric",
          month: "2-digit",
          day: "2-digit",
          hour: "2-digit",
          minute: "2-digit",
        });
      }

      function isBlockedImageUrl(url) {
        return /(^|\/\/)(cdn\.)?pixabay\.com/i.test(String(url || ""));
      }

      // opts:
      // - layout: "list" | "grid"
      // - showText: boolean  (Ï€ÏÎ¿ÎµÏ€Î¹ÏƒÎºÏŒÏ€Î·ÏƒÎ· ÎºÎµÎ¹Î¼Î­Î½Î¿Ï…)
      function renderNewsArticles(articles, opts = {}) {
        const { layout = "list", showText = true } = opts;

        const container = document.getElementById("content");
        container.innerHTML = "";

        if (!articles || !articles.length) {
          container.innerHTML = "<p>Î”ÎµÎ½ Î²ÏÎ­Î¸Î·ÎºÎ±Î½ ÎµÎ¹Î´Î®ÏƒÎµÎ¹Ï‚ Î³Î¹Î± Î±Ï…Ï„Î® Ï„Î·Î½ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î±.</p>";
          return;
        }

        let wrapper = container;
        if (layout === "grid") {
          wrapper = document.createElement("div");
          wrapper.className = "articles-grid";
          container.appendChild(wrapper);
        }

        for (const article of articles) {
          const card = document.createElement("article");
          card.className = "article-card";

          const href = article.id
            ? "article.html?id=" + encodeURIComponent(article.id) +
              "&category=" + encodeURIComponent(category)
            : null;

          // Î•Î¹ÎºÏŒÎ½Î± (Î® placeholder Î±Î½ Î»ÎµÎ¯Ï€ÎµÎ¹)
          if (article.imageUrl && !isBlockedImageUrl(article.imageUrl)) {
            const imgEl = document.createElement("img");
            imgEl.className = "article-thumb";
            imgEl.loading = "lazy";
            imgEl.src = article.imageUrl;
            imgEl.alt = article.simpleTitle || article.title || "Î•Î¹ÎºÏŒÎ½Î± Î¬ÏÎ¸ÏÎ¿Ï…";
            card.appendChild(imgEl);
          } else {
            const ph = document.createElement("div");
            ph.className = "article-thumb-placeholder";
            ph.setAttribute("aria-hidden", "true");
            ph.textContent = "ğŸ“°";
            card.appendChild(ph);
          }

          // Î¤Î¯Ï„Î»Î¿Ï‚ (Î±Ï€Î»Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î¿Ï‚)
          const titleEl = document.createElement("h2");
          if (href) {
            const titleLink = document.createElement("a");
            titleLink.href = href;
            titleLink.className = "text-decoration-none text-reset";
            titleLink.textContent = article.simpleTitle || article.title || "Î§Ï‰ÏÎ¯Ï‚ Ï„Î¯Ï„Î»Î¿";
            titleEl.appendChild(titleLink);
          } else {
            titleEl.textContent = article.simpleTitle || article.title || "Î§Ï‰ÏÎ¯Ï‚ Ï„Î¯Ï„Î»Î¿";
          }

          // Meta: Î¼ÏŒÎ½Î¿ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±/ÏÏÎ± (ÎŸÎ§Î™ Ï€Î·Î³Î­Ï‚ ÏƒÏ„Î·Î½ Ï€ÏÎ¿ÎµÏ€Î¹ÏƒÎºÏŒÏ€Î·ÏƒÎ·)
          const metaEl = document.createElement("div");
          metaEl.className = "meta";
          metaEl.textContent = formatPublishedAt(article.publishedAt);

          card.appendChild(titleEl);
          card.appendChild(metaEl);

          // Î ÏÎ¿Î±Î¹ÏÎµÏ„Î¹ÎºÏŒ preview ÎºÎµÎ¹Î¼Î­Î½Î¿Ï… (Î³Î¹Î± Î»Î¯ÏƒÏ„ÎµÏ‚ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¹ÏÎ½)
          if (showText) {
            const contentEl = document.createElement("div");
            contentEl.className = "content";
            contentEl.textContent = article.simpleText || "";
            card.appendChild(contentEl);
          }

          if (href) {
            card.addEventListener("click", (event) => {
              if (event.target.closest("a")) return;
              window.location.href = href;
            });
          }

          wrapper.appendChild(card);
        }
      }

      // ===== main init =====
      function setupSiteTitleReload() {
        const titleEl = document.querySelector(".site-title");
        if (!titleEl) return;

        titleEl.addEventListener("click", (event) => {
          event.preventDefault();
          window.location.reload();
        });
      }

      async function init() {
        try {
          const newsData = await loadJson("./news.json");
          const all = Array.isArray(newsData.articles) ? newsData.articles : [];
          const byCategory = newsData.articlesByCategory || {};
          const articles = category === "all" ? all : byCategory[category] || [];

          // ÎŒÎ»ÎµÏ‚ Î¿Î¹ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯ÎµÏ‚: grid Î¼Îµ ÎµÎ¹ÎºÏŒÎ½Î± + Ï„Î¯Ï„Î»Î¿ (Ï‡Ï‰ÏÎ¯Ï‚ preview ÎºÎµÎ¹Î¼Î­Î½Î¿Ï…)
          renderNewsArticles(articles, { layout: "grid", showText: false });
        } catch (err) {
          console.error(err);
          document.getElementById("content").innerHTML =
            "<p>Î¥Ï€Î®ÏÎ¾Îµ ÏƒÏ†Î¬Î»Î¼Î± ÎºÎ±Ï„Î¬ Ï„Î· Ï†ÏŒÏÏ„Ï‰ÏƒÎ· Ï„Ï‰Î½ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½.</p>";
        }
      }

      document.addEventListener("DOMContentLoaded", () => {
        setupSiteTitleReload();
        init();
      });
    </script>
  </body>
</html>
